fluent-bit-bridge code 
a k8s deployed bridge that connects fluent-bit to mongo to shuttle messages into collections
LOG ROUTING:
- Pods labeled `type: api` OR `type: service` → mongo: logging/logs  
- Everything else (Kong, system pods, etc.) → mongo: logging/system-logs

BUILD:
docker buildx build --platform linux/amd64 -t mtmazurik/fluent-bit-bridge:0.1.1 -t mtmazurik/fluent-bit-bridge:latest --push .

NOTE:  in Mongo ["system-logs"] we set to only keep 2 days worth, app logs (1 week)
// Auto-delete system logs after 2 days
db["system-logs"].createIndex(
  {"timestamp": 1}, 
  {expireAfterSeconds: 172800}  // 2 days = 172800 seconds
)
// Auto-delete application logs after 1 week (7 days)
db.logs.createIndex(
  {"timestamp": 1}, 
  {expireAfterSeconds: 604800}  // 7 days = 604800 seconds
)

USAGE:  tags in any compute deployment (in your service/api/app deployment.yaml)
-----------------------------
yamlapiVersion: apps/v1
kind: Deployment
metadata:
  name: cca-api
  namespace: cca-api
spec:
  template:
    metadata:
      labels:
        app: cca-api
        type: api        # ← Add this label
    spec:
      containers:
      - name: cca-api
        # ... rest of container spec
-----------------------------
For services:
spec:
  template:
    metadata:
      labels:
        app: my-service
        type: service    # ← Add this label

------------------------------
To filter app/service log messages
to mongo:   logging/logs

bifurcates to send other k8s messages (kong, fluent-bit startup, etc.)
to mongo:   logging/system-logs
-------------------------------
Deployment
deployment .yaml file lives in mtmazurik ~ (home) 
on admin node 
so stores in separate repo :   sre-configuration/fluent-bit-bridge
DEPLOY:
kubectl apply -f fluent-bit-bridge.yaml
kubectl apply -f configmap.yaml
kubectl rollout restart daemonset/fluent-bit -n logging
__________________________

Architecture document see: fluentbit_mongo_design.docx file

